<bound method Tag.prettify of <article class="md-content__inner md-typeset">
<h1 id="chapter-45-html5">Chapter 4&amp;5. HTML5 特性与编码规范</h1>
<h2 id="_1">文件类型和字符集</h2>
<p>这两样的定义变简单了。只需要</p>
<div class="language-html highlight"><pre><span></span><code><span id="__span-0-1"><a href="#__codelineno-0-1" id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="cp">&lt;!DOCTYPE HTML&gt;</span>
</span><span id="__span-0-2"><a href="#__codelineno-0-2" id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">"UTF-8"</span><span class="p">&gt;</span>
</span></code></pre></div>
<h2 id="_2">新元素</h2>
<h3 id="_3">语义与结构相关</h3>
<p>用 <code>&lt;div&gt;</code> 和 <code>&lt;span&gt;</code>，虽然可以搞出结构化页面，但是不知道这个结构里面是什么东西。语义相关元素可以让页面的格式与组织结构更加规范。</p>
<p><img alt="" src="https://s2.loli.net/2023/03/27/aJKO1PeMEDUirCY.png"/></p>
<p><img alt="" src="https://s2.loli.net/2023/03/27/H2Y7dIM8guX9ltN.png"/>
<img alt="" src="https://s2.loli.net/2023/03/27/ailpeU7bLXsVJGc.png"/></p>
<ul>
<li><code>&lt;section&gt;</code>，开闭之间表示一个章节部分，显示格式上没有什么特征，但是源代码结构很清晰</li>
<li><code>&lt;article&gt;</code>，类似 <code>&lt;section&gt;</code>，开闭之间表示文章。语义上，<code>&lt;article&gt;</code> 之间可以嵌套 <code>&lt;section&gt;</code>，<code>&lt;section&gt;</code> 当中也可以嵌套 <code>&lt;article&gt;</code>，它俩没有严格的谁大谁小的关系。</li>
</ul>
<h3 id="_4">表单相关</h3>
<p><img alt="" src="https://s2.loli.net/2023/03/27/ipmQcFwnI2KOLx8.png"/>
<img alt="" src="https://s2.loli.net/2023/03/27/k8AneYr6fLFTwUK.png"/></p>
<h3 id="_5">图像与音视频相关</h3>
<p><img alt="" src="https://s2.loli.net/2023/03/27/VIJX1NUkRo29pEW.png"/>
<img alt="" src="https://s2.loli.net/2023/03/27/zP5efC1i8a2Ubmu.png"/></p>
<h2 id="api">新 API</h2>
<p>地理位置的、拖动、本地存储、缓存、Web Worker、SSE</p>
<h2 id="_6">移除的与被代替的元素</h2>
<p><img alt="" src="https://s2.loli.net/2023/03/27/w25q9m4C71uIacs.png"/></p>
<p><strong>PPT 的 22 到 34 页没讲</strong></p>
<h2 id="html5-canvas">HTML5 的 Canvas（画布）</h2>
<p>顾名思义，用来画画的。然而，<code>&lt;canvas&gt;</code> 只是画布（容器），但是画布里面到底有什么，通常是通过结合 JavaScript 来控制的。</p>
<p>记得指定 id，这样方便 js 去找。</p>
<p>默认情况下，一块画布是空的矩形，没有边框。如果想要边框，可以 CSS 给他指定。</p>
<div class="language-html highlight"><pre><span></span><code><span id="__span-1-1"><a href="#__codelineno-1-1" id="__codelineno-1-1" name="__codelineno-1-1"></a><span class="p">&lt;</span><span class="nt">canvas</span> <span class="na">id</span><span class="o">=</span><span class="s">"myCanvas"</span> <span class="na">width</span><span class="o">=</span><span class="s">"200"</span> <span class="na">height</span><span class="o">=</span><span class="s">"200"</span> <span class="na">style</span><span class="o">=</span><span class="s">"border:1px solid black;"</span><span class="p">&gt;&lt;/</span><span class="nt">canvas</span><span class="p">&gt;</span>
</span></code></pre></div>
<div class="language-js highlight"><pre><span></span><code><span id="__span-2-1"><a href="#__codelineno-2-1" id="__codelineno-2-1" name="__codelineno-2-1"></a><span class="c1">// 绘制一个红色矩形</span>
</span><span id="__span-2-2"><a href="#__codelineno-2-2" id="__codelineno-2-2" name="__codelineno-2-2"></a><span class="kd">var</span><span class="w"> </span><span class="nx">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">"myCanvas"</span><span class="p">);</span>
</span><span id="__span-2-3"><a href="#__codelineno-2-3" id="__codelineno-2-3" name="__codelineno-2-3"></a><span class="kd">var</span><span class="w"> </span><span class="nx">ctx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">c</span><span class="p">.</span><span class="nx">getContext</span><span class="p">(</span><span class="s2">"2d"</span><span class="p">);</span><span class="w">  </span><span class="c1">// 表示是 2D 设备上下文（屏幕）的绘制</span>
</span><span id="__span-2-4"><a href="#__codelineno-2-4" id="__codelineno-2-4" name="__codelineno-2-4"></a><span class="nx">ctx</span><span class="p">.</span><span class="nx">fillStyle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#f00"</span><span class="p">;</span><span class="w">        </span><span class="c1">// 红色</span>
</span><span id="__span-2-5"><a href="#__codelineno-2-5" id="__codelineno-2-5" name="__codelineno-2-5"></a><span class="nx">ctx</span><span class="p">.</span><span class="nx">fillRect</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="mf">150</span><span class="p">,</span><span class="w"> </span><span class="mf">75</span><span class="p">);</span><span class="w">   </span><span class="c1">// 参数是矩形左上角的坐标及其 w, h</span>
</span></code></pre></div>
<div class="language-js highlight"><pre><span></span><code><span id="__span-3-1"><a href="#__codelineno-3-1" id="__codelineno-3-1" name="__codelineno-3-1"></a><span class="c1">// 绘制一条黑色实线</span>
</span><span id="__span-3-2"><a href="#__codelineno-3-2" id="__codelineno-3-2" name="__codelineno-3-2"></a><span class="kd">var</span><span class="w"> </span><span class="nx">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">"myCanvas"</span><span class="p">);</span>
</span><span id="__span-3-3"><a href="#__codelineno-3-3" id="__codelineno-3-3" name="__codelineno-3-3"></a><span class="kd">var</span><span class="w"> </span><span class="nx">ctx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">c</span><span class="p">.</span><span class="nx">getContext</span><span class="p">(</span><span class="s2">"2d"</span><span class="p">);</span>
</span><span id="__span-3-4"><a href="#__codelineno-3-4" id="__codelineno-3-4" name="__codelineno-3-4"></a><span class="nx">ctx</span><span class="p">.</span><span class="nx">moveTo</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">);</span>
</span><span id="__span-3-5"><a href="#__codelineno-3-5" id="__codelineno-3-5" name="__codelineno-3-5"></a><span class="nx">ctx</span><span class="p">.</span><span class="nx">lineTo</span><span class="p">(</span><span class="mf">200</span><span class="p">,</span><span class="w"> </span><span class="mf">100</span><span class="p">);</span><span class="w">          </span><span class="c1">// 指定了绘制的操作</span>
</span><span id="__span-3-6"><a href="#__codelineno-3-6" id="__codelineno-3-6" name="__codelineno-3-6"></a><span class="nx">ctx</span><span class="p">.</span><span class="nx">stroke</span><span class="p">();</span><span class="w">                  </span><span class="c1">// stroke 是画笔的意思，表示执行绘制操作，画出线段</span>
</span></code></pre></div>
<div class="language-js highlight"><pre><span></span><code><span id="__span-4-1"><a href="#__codelineno-4-1" id="__codelineno-4-1" name="__codelineno-4-1"></a><span class="c1">// 绘制一条绿色的 L 形状</span>
</span><span id="__span-4-2"><a href="#__codelineno-4-2" id="__codelineno-4-2" name="__codelineno-4-2"></a><span class="kd">var</span><span class="w"> </span><span class="nx">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">"myCanvas"</span><span class="p">);</span>
</span><span id="__span-4-3"><a href="#__codelineno-4-3" id="__codelineno-4-3" name="__codelineno-4-3"></a><span class="kd">var</span><span class="w"> </span><span class="nx">ctx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">c</span><span class="p">.</span><span class="nx">getContext</span><span class="p">(</span><span class="s2">"2d"</span><span class="p">);</span>
</span><span id="__span-4-4"><a href="#__codelineno-4-4" id="__codelineno-4-4" name="__codelineno-4-4"></a><span class="nx">ctx</span><span class="p">.</span><span class="nx">beginPath</span><span class="p">();</span><span class="w">            </span><span class="c1">// 告诉设备，现在要新绘制的是一条「路径」</span>
</span><span id="__span-4-5"><a href="#__codelineno-4-5" id="__codelineno-4-5" name="__codelineno-4-5"></a><span class="nx">ctx</span><span class="p">.</span><span class="nx">moveTo</span><span class="p">(</span><span class="mf">20</span><span class="p">,</span><span class="w"> </span><span class="mf">20</span><span class="p">);</span>
</span><span id="__span-4-6"><a href="#__codelineno-4-6" id="__codelineno-4-6" name="__codelineno-4-6"></a><span class="nx">ctx</span><span class="p">.</span><span class="nx">lineTo</span><span class="p">(</span><span class="mf">20</span><span class="p">,</span><span class="w"> </span><span class="mf">100</span><span class="p">);</span><span class="w">        </span><span class="c1">// 路径第一段，竖着的</span>
</span><span id="__span-4-7"><a href="#__codelineno-4-7" id="__codelineno-4-7" name="__codelineno-4-7"></a><span class="nx">ctx</span><span class="p">.</span><span class="nx">lineTo</span><span class="p">(</span><span class="mf">70</span><span class="p">,</span><span class="w"> </span><span class="mf">100</span><span class="p">);</span><span class="w">        </span><span class="c1">// 第二段，横着的</span>
</span><span id="__span-4-8"><a href="#__codelineno-4-8" id="__codelineno-4-8" name="__codelineno-4-8"></a><span class="nx">ctx</span><span class="p">.</span><span class="nx">strokeStyle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"green"</span><span class="p">;</span><span class="w">  </span><span class="c1">// 指定颜色</span>
</span><span id="__span-4-9"><a href="#__codelineno-4-9" id="__codelineno-4-9" name="__codelineno-4-9"></a><span class="nx">ctx</span><span class="p">.</span><span class="nx">stroke</span><span class="p">();</span>
</span></code></pre></div>
<div class="language-js highlight"><pre><span></span><code><span id="__span-5-1"><a href="#__codelineno-5-1" id="__codelineno-5-1" name="__codelineno-5-1"></a><span class="c1">// 绘制一个四分之三圆</span>
</span><span id="__span-5-2"><a href="#__codelineno-5-2" id="__codelineno-5-2" name="__codelineno-5-2"></a><span class="kd">var</span><span class="w"> </span><span class="nx">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">"myCanvas"</span><span class="p">);</span>
</span><span id="__span-5-3"><a href="#__codelineno-5-3" id="__codelineno-5-3" name="__codelineno-5-3"></a><span class="kd">var</span><span class="w"> </span><span class="nx">ctx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">c</span><span class="p">.</span><span class="nx">getContext</span><span class="p">(</span><span class="s2">"2d"</span><span class="p">);</span>
</span><span id="__span-5-4"><a href="#__codelineno-5-4" id="__codelineno-5-4" name="__codelineno-5-4"></a><span class="nx">ctx</span><span class="p">.</span><span class="nx">beginPath</span><span class="p">();</span>
</span><span id="__span-5-5"><a href="#__codelineno-5-5" id="__codelineno-5-5" name="__codelineno-5-5"></a><span class="c1">// 指定画一条弧的操作，前两个参数是圆心坐标，然后是半径</span>
</span><span id="__span-5-6"><a href="#__codelineno-5-6" id="__codelineno-5-6" name="__codelineno-5-6"></a><span class="c1">// 最后两个单位是以弧度（RAD）为单位的起始值、终止值（0~270°）</span>
</span><span id="__span-5-7"><a href="#__codelineno-5-7" id="__codelineno-5-7" name="__codelineno-5-7"></a><span class="c1">// 还有一个可选参数 counterclockwise（表示逆时针），默认取值 false，即默认顺时针</span>
</span><span id="__span-5-8"><a href="#__codelineno-5-8" id="__codelineno-5-8" name="__codelineno-5-8"></a><span class="nx">ctx</span><span class="p">.</span><span class="nx">arc</span><span class="p">(</span><span class="mf">100</span><span class="p">,</span><span class="w"> </span><span class="mf">75</span><span class="p">,</span><span class="w"> </span><span class="mf">50</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="mf">1.5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span><span class="p">);</span>
</span><span id="__span-5-9"><a href="#__codelineno-5-9" id="__codelineno-5-9" name="__codelineno-5-9"></a><span class="nx">ctx</span><span class="p">.</span><span class="nx">stroke</span><span class="p">();</span><span class="w">  </span><span class="c1">// 执行画弧操作（只是一圈）</span>
</span><span id="__span-5-10"><a href="#__codelineno-5-10" id="__codelineno-5-10" name="__codelineno-5-10"></a><span class="c1">// 如果想要画实心圆，可以指定 ctx.fillStyle 之后再 ctx.fill();</span>
</span></code></pre></div>
<div class="language-js highlight"><pre><span></span><code><span id="__span-6-1"><a href="#__codelineno-6-1" id="__codelineno-6-1" name="__codelineno-6-1"></a><span class="c1">// 写字</span>
</span><span id="__span-6-2"><a href="#__codelineno-6-2" id="__codelineno-6-2" name="__codelineno-6-2"></a><span class="kd">var</span><span class="w"> </span><span class="nx">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">"myCanvas"</span><span class="p">);</span>
</span><span id="__span-6-3"><a href="#__codelineno-6-3" id="__codelineno-6-3" name="__codelineno-6-3"></a><span class="kd">var</span><span class="w"> </span><span class="nx">ctx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">c</span><span class="p">.</span><span class="nx">getContext</span><span class="p">(</span><span class="s2">"2d"</span><span class="p">);</span>
</span><span id="__span-6-4"><a href="#__codelineno-6-4" id="__codelineno-6-4" name="__codelineno-6-4"></a><span class="nx">ctx</span><span class="p">.</span><span class="nx">font</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"30px Arial"</span><span class="p">;</span><span class="w">              </span><span class="c1">// 指定字号字体</span>
</span><span id="__span-6-5"><a href="#__codelineno-6-5" id="__codelineno-6-5" name="__codelineno-6-5"></a><span class="c1">// 四个参数，文字，起始坐标，最大宽度（可选）</span>
</span><span id="__span-6-6"><a href="#__codelineno-6-6" id="__codelineno-6-6" name="__codelineno-6-6"></a><span class="nx">ctx</span><span class="p">.</span><span class="nx">fillText</span><span class="p">(</span><span class="s2">"Hello world"</span><span class="p">,</span><span class="w"> </span><span class="mf">10</span><span class="p">,</span><span class="w"> </span><span class="mf">50</span><span class="p">);</span><span class="w">    </span><span class="c1">// 实心文字</span>
</span><span id="__span-6-7"><a href="#__codelineno-6-7" id="__codelineno-6-7" name="__codelineno-6-7"></a><span class="nx">ctx</span><span class="p">.</span><span class="nx">strokeText</span><span class="p">(</span><span class="s2">"Hello world"</span><span class="p">,</span><span class="w"> </span><span class="mf">100</span><span class="p">,</span><span class="w"> </span><span class="mf">150</span><span class="p">);</span><span class="w">  </span><span class="c1">// 空心浮雕文字</span>
</span><span id="__span-6-8"><a href="#__codelineno-6-8" id="__codelineno-6-8" name="__codelineno-6-8"></a><span class="c1">// 无需 stroke() 操作</span>
</span></code></pre></div>
<div class="language-js highlight"><pre><span></span><code><span id="__span-7-1"><a href="#__codelineno-7-1" id="__codelineno-7-1" name="__codelineno-7-1"></a><span class="c1">// 画图</span>
</span><span id="__span-7-2"><a href="#__codelineno-7-2" id="__codelineno-7-2" name="__codelineno-7-2"></a><span class="kd">var</span><span class="w"> </span><span class="nx">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">"myCanvas"</span><span class="p">);</span>
</span><span id="__span-7-3"><a href="#__codelineno-7-3" id="__codelineno-7-3" name="__codelineno-7-3"></a><span class="kd">var</span><span class="w"> </span><span class="nx">ctx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">c</span><span class="p">.</span><span class="nx">getContext</span><span class="p">(</span><span class="s2">"2d"</span><span class="p">);</span>
</span><span id="__span-7-4"><a href="#__codelineno-7-4" id="__codelineno-7-4" name="__codelineno-7-4"></a><span class="kd">var</span><span class="w"> </span><span class="nx">img</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">"its_id"</span><span class="p">);</span>
</span><span id="__span-7-5"><a href="#__codelineno-7-5" id="__codelineno-7-5" name="__codelineno-7-5"></a><span class="nx">ctx</span><span class="p">.</span><span class="nx">drawImage</span><span class="p">(</span><span class="nx">img</span><span class="p">,</span><span class="w"> </span><span class="mf">10</span><span class="p">,</span><span class="w"> </span><span class="mf">10</span><span class="p">);</span><span class="w">  </span><span class="c1">// 需要参数一个图片对象</span>
</span></code></pre></div>
<h2 id="html5">HTML5 的多媒体</h2>
<h3 id="_7">视频</h3>
<p>HTML5 之前只能通过 flash 等插件播放视频。</p>
<p>HTML5 可以直接通过 <code>&lt;video&gt;</code> 标签来嵌入一个视频，浏览器提供通用的播放方式：</p>
<div class="language-html highlight"><pre><span></span><code><span id="__span-8-1"><a href="#__codelineno-8-1" id="__codelineno-8-1" name="__codelineno-8-1"></a><span class="p">&lt;</span><span class="nt">video</span> <span class="na">width</span><span class="o">=</span><span class="s">""</span> <span class="na">height</span><span class="o">=</span><span class="s">""</span> <span class="na">controls</span><span class="p">&gt;</span>
</span><span id="__span-8-2"><a href="#__codelineno-8-2" id="__codelineno-8-2" name="__codelineno-8-2"></a>  <span class="p">&lt;</span><span class="nt">source</span> <span class="na">src</span><span class="o">=</span><span class="s">"v.mp4"</span> <span class="na">type</span><span class="o">=</span><span class="s">"video/mp4"</span><span class="p">&gt;</span>
</span><span id="__span-8-3"><a href="#__codelineno-8-3" id="__codelineno-8-3" name="__codelineno-8-3"></a>  <span class="p">&lt;</span><span class="nt">source</span> <span class="na">src</span><span class="o">=</span><span class="s">"v.ogg"</span> <span class="na">type</span><span class="o">=</span><span class="s">"video/ogg"</span><span class="p">&gt;</span>
</span><span id="__span-8-4"><a href="#__codelineno-8-4" id="__codelineno-8-4" name="__codelineno-8-4"></a>  <span class="p">&lt;</span><span class="nt">source</span> <span class="na">src</span><span class="o">=</span><span class="s">"v.webm"</span> <span class="na">type</span><span class="o">=</span><span class="s">"video/webm"</span><span class="p">&gt;</span>
</span><span id="__span-8-5"><a href="#__codelineno-8-5" id="__codelineno-8-5" name="__codelineno-8-5"></a>  <span class="cm">&lt;!-- 自动选择第一个支持的格式播放，如果都不支持，显示文本 --&gt;</span>
</span><span id="__span-8-6"><a href="#__codelineno-8-6" id="__codelineno-8-6" name="__codelineno-8-6"></a>  does not support the video.
</span><span id="__span-8-7"><a href="#__codelineno-8-7" id="__codelineno-8-7" name="__codelineno-8-7"></a><span class="p">&lt;/</span><span class="nt">video</span><span class="p">&gt;</span>
</span></code></pre></div>
<p>其中，<code>control</code> 属性的作用是，允许用户控制视频的播放、暂停、音量等状态。</p>
<p>可以使用 <code>autoplay</code> 属性指定加载时自动播放（需要浏览器支持）</p>
<h4 id="dom">DOM 事件</h4>
<p>播放、暂停等事件发生，都会有 DOM 事件。</p>
<h3 id="_8">音频</h3>
<p>同视频，HTML5 之前没有通用的播放标准。</p>
<p>音频与视频几乎一模一样，只是 <code>&lt;video&gt;</code> 换成了 <code>&lt;audio&gt;</code>。</p>
<h2 id="html5-api">HTML5 的地理位置 API</h2>
<p>当用户授权后，即可以通过 API 获取用户的地理位置。需要配合 JS。</p>
<div class="language-js highlight"><pre><span></span><code><span id="__span-9-1"><a href="#__codelineno-9-1" id="__codelineno-9-1" name="__codelineno-9-1"></a><span class="kd">function</span><span class="w"> </span><span class="nx">getLocation</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-9-2"><a href="#__codelineno-9-2" id="__codelineno-9-2" name="__codelineno-9-2"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">navigator</span><span class="p">.</span><span class="nx">geolocation</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// 检查是否支持地理位置 API</span>
</span><span id="__span-9-3"><a href="#__codelineno-9-3" id="__codelineno-9-3" name="__codelineno-9-3"></a><span class="w">    </span><span class="c1">// 两个回调函数作为参数，第一个用来显示坐标，第二个用来显示错误信息</span>
</span><span id="__span-9-4"><a href="#__codelineno-9-4" id="__codelineno-9-4" name="__codelineno-9-4"></a><span class="w">    </span><span class="nx">navigator</span><span class="p">.</span><span class="nx">geolocation</span><span class="p">.</span><span class="nx">getCurrentPosition</span><span class="p">(</span><span class="nx">showPosition</span><span class="p">,</span><span class="w"> </span><span class="nx">showError</span><span class="p">);</span>
</span><span id="__span-9-5"><a href="#__codelineno-9-5" id="__codelineno-9-5" name="__codelineno-9-5"></a><span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-9-6"><a href="#__codelineno-9-6" id="__codelineno-9-6" name="__codelineno-9-6"></a><span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"不支持"</span><span class="p">);</span>
</span><span id="__span-9-7"><a href="#__codelineno-9-7" id="__codelineno-9-7" name="__codelineno-9-7"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-9-8"><a href="#__codelineno-9-8" id="__codelineno-9-8" name="__codelineno-9-8"></a><span class="p">}</span>
</span><span id="__span-9-9"><a href="#__codelineno-9-9" id="__codelineno-9-9" name="__codelineno-9-9"></a><span class="kd">function</span><span class="w"> </span><span class="nx">showPosition</span><span class="p">(</span><span class="nx">position</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// 回调函数</span>
</span><span id="__span-9-10"><a href="#__codelineno-9-10" id="__codelineno-9-10" name="__codelineno-9-10"></a><span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"Latitude: "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">position</span><span class="p">.</span><span class="nx">coords</span><span class="p">.</span><span class="nx">latitude</span><span class="p">);</span>
</span><span id="__span-9-11"><a href="#__codelineno-9-11" id="__codelineno-9-11" name="__codelineno-9-11"></a><span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"Longitude: "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">position</span><span class="p">.</span><span class="nx">coords</span><span class="p">.</span><span class="nx">longitude</span><span class="p">);</span>
</span><span id="__span-9-12"><a href="#__codelineno-9-12" id="__codelineno-9-12" name="__codelineno-9-12"></a><span class="p">}</span>
</span><span id="__span-9-13"><a href="#__codelineno-9-13" id="__codelineno-9-13" name="__codelineno-9-13"></a>
</span><span id="__span-9-14"><a href="#__codelineno-9-14" id="__codelineno-9-14" name="__codelineno-9-14"></a><span class="kd">function</span><span class="w"> </span><span class="nx">showError</span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-9-15"><a href="#__codelineno-9-15" id="__codelineno-9-15" name="__codelineno-9-15"></a><span class="w">  </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">.</span><span class="nx">code</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-9-16"><a href="#__codelineno-9-16" id="__codelineno-9-16" name="__codelineno-9-16"></a><span class="w">    </span><span class="c1">// blabla</span>
</span><span id="__span-9-17"><a href="#__codelineno-9-17" id="__codelineno-9-17" name="__codelineno-9-17"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-9-18"><a href="#__codelineno-9-18" id="__codelineno-9-18" name="__codelineno-9-18"></a><span class="p">}</span>
</span></code></pre></div>
<p>关于 <code>getCurrentPosition()</code> 的返回内容（精度、海拔、朝向、速度、时间戳等）的更详细信息：</p>
<p><img alt="" src="https://s2.loli.net/2023/04/10/UXBDQxVswAr6FEz.png"/></p>
<p>此外还有一个叫做 <code>watchPosition()</code> 的东西，用于持续获取位置信息（监听轨迹）。当不再需要监听，用 <code>clearWatch()</code> 停止。</p>
<h2 id="html5-dragdrop">HTML5 的拖动（Drag&amp;Drop）</h2>
<p>也需要配合 JS。</p>
<p>拖拽需要若干个步骤，下面进行详细解释</p>
<h3 id="1-draggable">1. 要设置元素为「draggable」</h3>
<p>方法是，在标签中，将 <code>draggable</code> 属性设置为 <code>true</code>；同时记得设置 id 方便 js 代码对应：</p>
<div class="language-html highlight"><pre><span></span><code><span id="__span-10-1"><a href="#__codelineno-10-1" id="__codelineno-10-1" name="__codelineno-10-1"></a><span class="p">&lt;</span><span class="nt">img</span> <span class="na">id</span><span class="o">=</span><span class="s">"drag1"</span> <span class="na">src</span><span class="o">=</span><span class="s">"smiley.gif"</span> <span class="na">draggable</span><span class="o">=</span><span class="s">"true"</span><span class="p">&gt;</span>
</span></code></pre></div>
<h3 id="2">2. 从哪里拖</h3>
<p>要设置被拖拽元素的 <code>ondragstart</code> 属性（通常是个函数），表示</p>
<div class="language-html highlight"><pre><span></span><code><span id="__span-11-1"><a href="#__codelineno-11-1" id="__codelineno-11-1" name="__codelineno-11-1"></a><span class="p">&lt;</span><span class="nt">img</span> <span class="na">id</span><span class="o">=</span><span class="s">"drag1"</span> <span class="na">src</span><span class="o">=</span><span class="s">"smiley.gif"</span> <span class="na">draggable</span><span class="o">=</span><span class="s">"true"</span> <span class="na">ondragstart</span><span class="o">=</span><span class="s">"drag(event)"</span><span class="p">&gt;</span>
</span></code></pre></div>
<p>此外，在调用的函数中，通过 <code>dataTransfer.setData()</code> 设置被拖拽的数据类型和数据值</p>
<div class="language-js highlight"><pre><span></span><code><span id="__span-12-1"><a href="#__codelineno-12-1" id="__codelineno-12-1" name="__codelineno-12-1"></a><span class="kd">function</span><span class="w"> </span><span class="nx">drag</span><span class="p">(</span><span class="nx">ev</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-2"><a href="#__codelineno-12-2" id="__codelineno-12-2" name="__codelineno-12-2"></a><span class="w">  </span><span class="nx">ev</span><span class="p">.</span><span class="nx">dataTransfer</span><span class="p">.</span><span class="nx">setData</span><span class="p">(</span><span class="s2">"text"</span><span class="p">,</span><span class="w"> </span><span class="nx">ev</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">id</span><span class="p">);</span>
</span><span id="__span-12-3"><a href="#__codelineno-12-3" id="__codelineno-12-3" name="__codelineno-12-3"></a><span class="p">}</span>
</span></code></pre></div>
<h3 id="3">3. 拖到哪里</h3>
<p>设置目标位置元素的 <code>ondragover</code> 属性，先允许接收</p>
<div class="language-html highlight"><pre><span></span><code><span id="__span-13-1"><a href="#__codelineno-13-1" id="__codelineno-13-1" name="__codelineno-13-1"></a><span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">"div1"</span> <span class="na">ondrop</span><span class="o">=</span><span class="s">"drop(event)"</span> <span class="na">ondragover</span><span class="o">=</span><span class="s">"allowDrop(event)"</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></code></pre></div>
<div class="language-js highlight"><pre><span></span><code><span id="__span-14-1"><a href="#__codelineno-14-1" id="__codelineno-14-1" name="__codelineno-14-1"></a><span class="kd">function</span><span class="w"> </span><span class="nx">allowDrop</span><span class="p">(</span><span class="nx">ev</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-14-2"><a href="#__codelineno-14-2" id="__codelineno-14-2" name="__codelineno-14-2"></a><span class="w">  </span><span class="nx">ev</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
</span><span id="__span-14-3"><a href="#__codelineno-14-3" id="__codelineno-14-3" name="__codelineno-14-3"></a><span class="p">}</span>
</span></code></pre></div>
<p>其中，<code>preventDefault()</code> 用于组织浏览器默认策略（默认不允许拖拽）。然后设置拖完做什么：</p>
<div class="language-js highlight"><pre><span></span><code><span id="__span-15-1"><a href="#__codelineno-15-1" id="__codelineno-15-1" name="__codelineno-15-1"></a><span class="kd">function</span><span class="w"> </span><span class="nx">drop</span><span class="p">(</span><span class="nx">ev</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-15-2"><a href="#__codelineno-15-2" id="__codelineno-15-2" name="__codelineno-15-2"></a><span class="w">  </span><span class="nx">ev</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
</span><span id="__span-15-3"><a href="#__codelineno-15-3" id="__codelineno-15-3" name="__codelineno-15-3"></a><span class="w">  </span><span class="kd">var</span><span class="w"> </span><span class="nx">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">ev</span><span class="p">.</span><span class="nx">dataTransfer</span><span class="p">.</span><span class="nx">getData</span><span class="p">(</span><span class="s2">"text"</span><span class="p">);</span>
</span><span id="__span-15-4"><a href="#__codelineno-15-4" id="__codelineno-15-4" name="__codelineno-15-4"></a><span class="w">      </span><span class="nx">ev</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="nx">data</span><span class="p">));</span>
</span><span id="__span-15-5"><a href="#__codelineno-15-5" id="__codelineno-15-5" name="__codelineno-15-5"></a><span class="w">  </span><span class="c1">// ev.target 是目标元素</span>
</span><span id="__span-15-6"><a href="#__codelineno-15-6" id="__codelineno-15-6" name="__codelineno-15-6"></a><span class="p">}</span>
</span></code></pre></div>
<h3 id="4">4. 成品代码</h3>
<p><img alt="" src="https://s2.loli.net/2023/04/10/AhgDbZzQBkpNL6w.png"/>
<img alt="" src="https://s2.loli.net/2023/04/10/Qoe8gYACnpkSDKy.png"/></p>
<h2 id="html5_1">HTML5 的本地存储</h2>
<p>HTML5 之前基本只能是 cookie 存储信息。但是这不安全，因为 cookie 要跟服务器传来传去的，所以存储的信息量也不可能大。</p>
<p>每个 origin（每个 domain 和 protocol）的页面，都可以存储和访问相同的数据。</p>
<p>HTML 提供了两个对象，用于存储数据：</p>
<ul>
<li><code>window.localStorage</code>，<strong>永久</strong> 存储数据</li>
<li><code>window.sessionStorge</code>，每个会话都独立，会话结束即标签页关闭后数据就会丢失</li>
</ul>
<p>它们用键值对（<code>getItem</code> 与 <code>setItem</code>）来读写。存储的形式是 <strong>字符串</strong>。所以如果存储的是数字，要进行类型转换才能进行加减乘除之类的运算。</p>
<p>使用这两个对象前，要用 js 检查一下浏览器是否支持</p>
<div class="language-js highlight"><pre><span></span><code><span id="__span-16-1"><a href="#__codelineno-16-1" id="__codelineno-16-1" name="__codelineno-16-1"></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="ow">typeof</span><span class="p">(</span><span class="nx">Storage</span><span class="p">)</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="s2">"undefined"</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-16-2"><a href="#__codelineno-16-2" id="__codelineno-16-2" name="__codelineno-16-2"></a><span class="w">  </span><span class="c1">// 支持，进行处理</span>
</span><span id="__span-16-3"><a href="#__codelineno-16-3" id="__codelineno-16-3" name="__codelineno-16-3"></a><span class="w">  </span><span class="nx">localStorage</span><span class="p">.</span><span class="nx">setItem</span><span class="p">(</span><span class="s2">"lastname"</span><span class="p">,</span><span class="w"> </span><span class="s2">"smith"</span><span class="p">);</span><span class="w"> </span><span class="c1">// 存</span>
</span><span id="__span-16-4"><a href="#__codelineno-16-4" id="__codelineno-16-4" name="__codelineno-16-4"></a><span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">localStorage</span><span class="p">.</span><span class="nx">getItem</span><span class="p">(</span><span class="s2">"lastname"</span><span class="p">));</span><span class="w"> </span><span class="c1">// 取</span>
</span><span id="__span-16-5"><a href="#__codelineno-16-5" id="__codelineno-16-5" name="__codelineno-16-5"></a>
</span><span id="__span-16-6"><a href="#__codelineno-16-6" id="__codelineno-16-6" name="__codelineno-16-6"></a><span class="w">  </span><span class="c1">// 这样也可以</span>
</span><span id="__span-16-7"><a href="#__codelineno-16-7" id="__codelineno-16-7" name="__codelineno-16-7"></a><span class="w">  </span><span class="nx">localStorage</span><span class="p">.</span><span class="nx">lastname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"smith"</span><span class="p">;</span><span class="w"> </span><span class="c1">// 存</span>
</span><span id="__span-16-8"><a href="#__codelineno-16-8" id="__codelineno-16-8" name="__codelineno-16-8"></a><span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">localStorage</span><span class="p">.</span><span class="nx">lastname</span><span class="p">);</span><span class="w"> </span><span class="c1">// 取</span>
</span><span id="__span-16-9"><a href="#__codelineno-16-9" id="__codelineno-16-9" name="__codelineno-16-9"></a>
</span><span id="__span-16-10"><a href="#__codelineno-16-10" id="__codelineno-16-10" name="__codelineno-16-10"></a><span class="w">  </span><span class="nx">localStorage</span><span class="p">.</span><span class="nx">removeItem</span><span class="p">(</span><span class="s2">"lastname"</span><span class="p">);</span><span class="w"> </span><span class="c1">// 删掉</span>
</span><span id="__span-16-11"><a href="#__codelineno-16-11" id="__codelineno-16-11" name="__codelineno-16-11"></a>
</span><span id="__span-16-12"><a href="#__codelineno-16-12" id="__codelineno-16-12" name="__codelineno-16-12"></a><span class="w">  </span><span class="c1">// 注意类型转换，否则就是字符串拼接了</span>
</span><span id="__span-16-13"><a href="#__codelineno-16-13" id="__codelineno-16-13" name="__codelineno-16-13"></a><span class="w">  </span><span class="nx">localStorage</span><span class="p">.</span><span class="nx">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">localStorage</span><span class="p">.</span><span class="nx">count</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1</span><span class="p">;</span><span class="w"> </span><span class="c1">// 改</span>
</span><span id="__span-16-14"><a href="#__codelineno-16-14" id="__codelineno-16-14" name="__codelineno-16-14"></a><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-16-15"><a href="#__codelineno-16-15" id="__codelineno-16-15" name="__codelineno-16-15"></a><span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"不支持"</span><span class="p">);</span>
</span><span id="__span-16-16"><a href="#__codelineno-16-16" id="__codelineno-16-16" name="__codelineno-16-16"></a><span class="p">}</span>
</span></code></pre></div>
<h2 id="html5-web-worker">HTML5 的 Web Worker</h2>
<p>WW 说白了就是后台运行的一个脚本线程。</p>
<p>因为 JS 运行的时候，页面是不会进行响应的（卡住），所以如果有复杂的代码要执行，就最好设置成 web worker。</p>
<p>首先用 JS 检查是否支持 WW，如果支持就创建一个 WW 对象。</p>
<div class="language-js highlight"><pre><span></span><code><span id="__span-17-1"><a href="#__codelineno-17-1" id="__codelineno-17-1" name="__codelineno-17-1"></a><span class="kd">var</span><span class="w"> </span><span class="nx">w</span><span class="p">;</span>
</span><span id="__span-17-2"><a href="#__codelineno-17-2" id="__codelineno-17-2" name="__codelineno-17-2"></a><span class="kd">function</span><span class="w"> </span><span class="nx">startWorker</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-17-3"><a href="#__codelineno-17-3" id="__codelineno-17-3" name="__codelineno-17-3"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="ow">typeof</span><span class="p">(</span><span class="nx">Worker</span><span class="p">)</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="s2">"undefined"</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-17-4"><a href="#__codelineno-17-4" id="__codelineno-17-4" name="__codelineno-17-4"></a><span class="w">    </span><span class="c1">// 支持</span>
</span><span id="__span-17-5"><a href="#__codelineno-17-5" id="__codelineno-17-5" name="__codelineno-17-5"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="ow">typeof</span><span class="p">(</span><span class="nx">w</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"undefined"</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-17-6"><a href="#__codelineno-17-6" id="__codelineno-17-6" name="__codelineno-17-6"></a><span class="w">      </span><span class="c1">// 不存在 worker 对象，建一个新的</span>
</span><span id="__span-17-7"><a href="#__codelineno-17-7" id="__codelineno-17-7" name="__codelineno-17-7"></a><span class="w">      </span><span class="nx">w</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">Worker</span><span class="p">(</span><span class="s2">"demo_worker.js"</span><span class="p">);</span><span class="w"> </span><span class="c1">// 外部脚本</span>
</span><span id="__span-17-8"><a href="#__codelineno-17-8" id="__codelineno-17-8" name="__codelineno-17-8"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-17-9"><a href="#__codelineno-17-9" id="__codelineno-17-9" name="__codelineno-17-9"></a><span class="w">    </span><span class="nx">w</span><span class="p">.</span><span class="nx">onMessage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-17-10"><a href="#__codelineno-17-10" id="__codelineno-17-10" name="__codelineno-17-10"></a><span class="w">      </span><span class="c1">// 定义事件响应函数</span>
</span><span id="__span-17-11"><a href="#__codelineno-17-11" id="__codelineno-17-11" name="__codelineno-17-11"></a><span class="w">      </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">data</span><span class="p">);</span><span class="w"> </span><span class="c1">// event.data 就是接收的数据</span>
</span><span id="__span-17-12"><a href="#__codelineno-17-12" id="__codelineno-17-12" name="__codelineno-17-12"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-17-13"><a href="#__codelineno-17-13" id="__codelineno-17-13" name="__codelineno-17-13"></a><span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-17-14"><a href="#__codelineno-17-14" id="__codelineno-17-14" name="__codelineno-17-14"></a><span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"不支持"</span><span class="p">);</span>
</span><span id="__span-17-15"><a href="#__codelineno-17-15" id="__codelineno-17-15" name="__codelineno-17-15"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-17-16"><a href="#__codelineno-17-16" id="__codelineno-17-16" name="__codelineno-17-16"></a><span class="p">}</span>
</span><span id="__span-17-17"><a href="#__codelineno-17-17" id="__codelineno-17-17" name="__codelineno-17-17"></a><span class="kd">function</span><span class="w"> </span><span class="nx">stopWorker</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-17-18"><a href="#__codelineno-17-18" id="__codelineno-17-18" name="__codelineno-17-18"></a><span class="w">  </span><span class="c1">// 就算外部脚本执行完了，ww 也一直会监听有没有消息传来</span>
</span><span id="__span-17-19"><a href="#__codelineno-17-19" id="__codelineno-17-19" name="__codelineno-17-19"></a><span class="w">  </span><span class="c1">// 因此要记得终止掉这个 ww，并重置掉</span>
</span><span id="__span-17-20"><a href="#__codelineno-17-20" id="__codelineno-17-20" name="__codelineno-17-20"></a><span class="w">  </span><span class="nx">w</span><span class="p">.</span><span class="nx">terminate</span><span class="p">();</span>
</span><span id="__span-17-21"><a href="#__codelineno-17-21" id="__codelineno-17-21" name="__codelineno-17-21"></a><span class="w">  </span><span class="nx">w</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">undefined</span><span class="p">;</span>
</span><span id="__span-17-22"><a href="#__codelineno-17-22" id="__codelineno-17-22" name="__codelineno-17-22"></a><span class="p">}</span>
</span></code></pre></div>
<div class="language-js highlight"><pre><span></span><code><span id="__span-18-1"><a href="#__codelineno-18-1" id="__codelineno-18-1" name="__codelineno-18-1"></a><span class="c1">// demo_worker.js</span>
</span><span id="__span-18-2"><a href="#__codelineno-18-2" id="__codelineno-18-2" name="__codelineno-18-2"></a><span class="kd">var</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>
</span><span id="__span-18-3"><a href="#__codelineno-18-3" id="__codelineno-18-3" name="__codelineno-18-3"></a><span class="kd">function</span><span class="w"> </span><span class="nx">timedCount</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-18-4"><a href="#__codelineno-18-4" id="__codelineno-18-4" name="__codelineno-18-4"></a><span class="w">  </span><span class="nx">i</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mf">1</span><span class="p">;</span>
</span><span id="__span-18-5"><a href="#__codelineno-18-5" id="__codelineno-18-5" name="__codelineno-18-5"></a><span class="w">  </span><span class="nx">postMessage</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span><span class="w">  </span><span class="c1">// 把 i 作为 event.data 发送</span>
</span><span id="__span-18-6"><a href="#__codelineno-18-6" id="__codelineno-18-6" name="__codelineno-18-6"></a><span class="w">  </span><span class="nx">setTimeout</span><span class="p">(</span><span class="s2">"timedCount()"</span><span class="p">,</span><span class="w"> </span><span class="mf">500</span><span class="p">);</span>
</span><span id="__span-18-7"><a href="#__codelineno-18-7" id="__codelineno-18-7" name="__codelineno-18-7"></a><span class="p">}</span>
</span><span id="__span-18-8"><a href="#__codelineno-18-8" id="__codelineno-18-8" name="__codelineno-18-8"></a><span class="nx">timedCount</span><span class="p">();</span>
</span></code></pre></div>
<h3 id="ww-dom">WW 与 DOM</h3>
<p>由于 WW 调用的是外部脚本，所以无法访问部分对象（<code>window</code>、<code>document</code> 等）。因此 WW 存在一定缺陷。</p>
<h2 id="html4-html5">HTML4 到 HTML5 的迁移</h2>
<h3 id="_9">语义元素</h3>
<p>HTML4 当中有一些约定成俗的写法（<code>&lt;div&gt;</code> 配合 <code>id</code>），在 HTML5 当中有了对应的标签元素。对应的 CSS 替换也类似。</p>
<p><img alt="" src="https://s2.loli.net/2023/04/03/tnV84edX7QfqPpA.png"/></p>
<h3 id="_10">元数据</h3>
<p>HTML4 当中的 doctype 与编码定义很繁琐：</p>
<div class="language-html highlight"><pre><span></span><code><span id="__span-19-1"><a href="#__codelineno-19-1" id="__codelineno-19-1" name="__codelineno-19-1"></a><span class="cp">&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd"&gt;</span>
</span><span id="__span-19-2"><a href="#__codelineno-19-2" id="__codelineno-19-2" name="__codelineno-19-2"></a><span class="p">&lt;</span><span class="nt">meta</span> <span class="na">http-equiv</span><span class="o">=</span><span class="s">"Content-Type"</span> <span class="na">content</span><span class="o">=</span><span class="s">"text/html; charset=utf-8"</span><span class="p">&gt;</span>
</span></code></pre></div>
<p>到 HTML5 仅仅是两行：</p>
<div class="language-html highlight"><pre><span></span><code><span id="__span-20-1"><a href="#__codelineno-20-1" id="__codelineno-20-1" name="__codelineno-20-1"></a><span class="cp">&lt;!DOCTYPE html&gt;</span>
</span><span id="__span-20-2"><a href="#__codelineno-20-2" id="__codelineno-20-2" name="__codelineno-20-2"></a><span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">"utf-8"</span><span class="p">&gt;</span>
</span></code></pre></div>
<h2 id="html5_2">HTML5 的代码风格与惯例</h2>
<p>有些场合下，需要用 XML 解析器（对编码更严格）来解析 HTML。因此，使用更接近 XML 的严格语法，是更明智的、更好的习惯。</p>
<h3 id="_11">无论如何都要声明文件类型</h3>
<div class="language-html highlight"><pre><span></span><code><span id="__span-21-1"><a href="#__codelineno-21-1" id="__codelineno-21-1" name="__codelineno-21-1"></a><span class="cp">&lt;!DOCTYPE html&gt;</span>
</span><span id="__span-21-2"><a href="#__codelineno-21-2" id="__codelineno-21-2" name="__codelineno-21-2"></a><span class="cp">&lt;!doctype html&gt;</span>
</span></code></pre></div>
<p>两种写法均可</p>
<h3 id="_12">始终使用小写名称</h3>
<p>HTML5 允许混用大小写，但是这不好。应当：</p>
<ul>
<li>不应混用大小写</li>
<li>XHTML 当中都是小写的</li>
<li>小写的看起来更简洁（看大写的反应时间会比看小写慢）</li>
<li>小写的写起来也方便（不需要一直按住 shift 键）</li>
</ul>
<p>不管是标签还是属性，都应当保持小写。</p>
<h4 id="_13">文件名也要小写</h4>
<p>大部分服务器（Apache 等）对于文件名都是大小写敏感的。但是也有的服务器（IIS 等）大小写不敏感。</p>
<p>因此如果混用大小写，就要非常严格的检查。为了避免不必要的麻烦，应当统一使用小写的文件名。</p>
<h3 id="_14">要把所有元素都关闭掉</h3>
<p>比如这样子，虽然能给 HTML5 解析器解析出来，但是很不好</p>
<div class="language-html highlight"><pre><span></span><code><span id="__span-22-1"><a href="#__codelineno-22-1" id="__codelineno-22-1" name="__codelineno-22-1"></a><span class="p">&lt;</span><span class="nt">section</span><span class="p">&gt;</span>
</span><span id="__span-22-2"><a href="#__codelineno-22-2" id="__codelineno-22-2" name="__codelineno-22-2"></a><span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>hahaha
</span><span id="__span-22-3"><a href="#__codelineno-22-3" id="__codelineno-22-3" name="__codelineno-22-3"></a><span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>hahaha
</span><span id="__span-22-4"><a href="#__codelineno-22-4" id="__codelineno-22-4" name="__codelineno-22-4"></a><span class="p">&lt;/</span><span class="nt">section</span><span class="p">&gt;</span>
</span></code></pre></div>
<p>上述未关闭的写法是不能被 XML 解析器解析的。应当改成</p>
<div class="language-html highlight"><pre><span></span><code><span id="__span-23-1"><a href="#__codelineno-23-1" id="__codelineno-23-1" name="__codelineno-23-1"></a><span class="p">&lt;</span><span class="nt">section</span><span class="p">&gt;</span>
</span><span id="__span-23-2"><a href="#__codelineno-23-2" id="__codelineno-23-2" name="__codelineno-23-2"></a><span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>hahaha<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
</span><span id="__span-23-3"><a href="#__codelineno-23-3" id="__codelineno-23-3" name="__codelineno-23-3"></a><span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>hahaha<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
</span><span id="__span-23-4"><a href="#__codelineno-23-4" id="__codelineno-23-4" name="__codelineno-23-4"></a><span class="p">&lt;/</span><span class="nt">section</span><span class="p">&gt;</span>
</span></code></pre></div>
<p>甚至，没有 closing tag 的标签也应当关闭，以符合严格的 XML 规范，比如：</p>
<div class="language-html highlight"><pre><span></span><code><span id="__span-24-1"><a href="#__codelineno-24-1" id="__codelineno-24-1" name="__codelineno-24-1"></a><span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">"utf-8"</span> <span class="p">/&gt;</span>
</span><span id="__span-24-2"><a href="#__codelineno-24-2" id="__codelineno-24-2" name="__codelineno-24-2"></a><span class="p">&lt;</span><span class="nt">br</span> <span class="p">/&gt;</span>
</span><span id="__span-24-3"><a href="#__codelineno-24-3" id="__codelineno-24-3" name="__codelineno-24-3"></a><span class="p">&lt;</span><span class="nt">hr</span> <span class="p">/&gt;</span>
</span></code></pre></div>
<h3 id="_15">正确使用引号</h3>
<p>HTML5 是允许属性值不加（双）引号的。但是，应当尽量使用，因为：</p>
<ul>
<li>如果属性值当中含有空格，必须使用引号，比如 <code>class</code> 属性经常带空格，就必须有引号</li>
<li>使用引号可以让属性名和属性值易于区分</li>
<li>如果有的用了引号，有的没用引号，那太丑了</li>
</ul>
<h3 id="_16">对于图片</h3>
<p>应当一定要记得使用 <code>alt</code> 属性，万一图片无法显示，可以让浏览器显示提示信息。</p>
<p>同时，应当一定要记得指定图片大小（宽度高度）。否则，图像在加载成功前，可能是原始大小，其他元素加载完成后，浏览器可能会闪一下（flicker）这张图的尺寸，调整显示效果。</p>
<h3 id="_17">关于空格</h3>
<p>很多语言当中，等号 <code>=</code> 左右两边都提倡有空格。但是，HTML5 当中，尽量不要加空格，空格少可以让代码更加清晰易读：</p>
<div class="language-html highlight"><pre><span></span><code><span id="__span-25-1"><a href="#__codelineno-25-1" id="__codelineno-25-1" name="__codelineno-25-1"></a><span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel </span><span class="o">=</span> <span class="s">"stylesheet"</span> <span class="na">href </span><span class="o">=</span> <span class="s">"style.css"</span><span class="p">&gt;</span>
</span><span id="__span-25-2"><a href="#__codelineno-25-2" id="__codelineno-25-2" name="__codelineno-25-2"></a><span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">"stylesheet"</span> <span class="na">href</span><span class="o">=</span><span class="s">"style.css"</span><span class="p">&gt;</span>
</span></code></pre></div>
<h3 id="_18">避免一行太长</h3>
<p>由于一些上古编辑器，左右显示宽度是 80，且不方便左右滚动，所以应当尽量避免一行字符多于 80.</p>
<p>不过现代编辑器一般都不会这么傻。所以这不是强制性的。</p>
<h3 id="indent">空行与缩进（indent）问题</h3>
<ul>
<li>不要随便加空行，也不要随便加缩进，比如两个小代码块之间，两个同级 <code>&lt;input&gt;</code> 之间，无需空行，无需缩进</li>
<li>对于逻辑意义上有差异的代码段，中间可以加上空行，保持代码结构清晰</li>
<li>为了可读性，不要用 TAB 进行缩进，用 2-spaces 会更好</li>
</ul>
<p>像这样，这么多空行空格，就很没有必要（尤其是文字当中的空行空格，根本没用）。虽然他长得很像是符合 markdown 规范，但是在 HTML 里面就是不好。</p>
<p><img alt="" src="https://s2.loli.net/2023/04/03/DKLqpWT4JtumHiQ.png"/></p>
<p>应当改成</p>
<p><img alt="" src="https://s2.loli.net/2023/04/03/hrx9fF7J4NEKezA.png"/></p>
<h3 id="html-body">不要忽略 <code>&lt;html&gt;</code> 与 <code>&lt;body&gt;</code> 等</h3>
<p>HTML5 允许忽略 <code>&lt;html&gt;</code> 与 <code>&lt;body&gt;</code> 和 <code>&lt;head&gt;</code>。但是不推荐。因为这可能导致部分浏览器异常显示，以及可能会让 XML 解析器崩溃。</p>
<p>此外，<code>&lt;html&gt;</code> 标签当中可以用 <code>lang</code> 属性指定语言。比如：<code>&lt;html lang="en-US"&gt;</code>。这对于屏幕阅读器和搜索引擎比较有意义。</p>
<h3 id="_19">关于注释</h3>
<p>比较短的注释写在一行以内就可以了：<code>&lt;!-- 记得注释两头有空格 --&gt;</code>；比较长的注释建议这样：</p>
<div class="language-html highlight"><pre><span></span><code><span id="__span-26-1"><a href="#__codelineno-26-1" id="__codelineno-26-1" name="__codelineno-26-1"></a><span class="cm">&lt;!--</span>
</span><span id="__span-26-2"><a href="#__codelineno-26-2" id="__codelineno-26-2" name="__codelineno-26-2"></a><span class="cm">  2-spaces indent</span>
</span><span id="__span-26-3"><a href="#__codelineno-26-3" id="__codelineno-26-3" name="__codelineno-26-3"></a><span class="cm">  blabla blabla</span>
</span><span id="__span-26-4"><a href="#__codelineno-26-4" id="__codelineno-26-4" name="__codelineno-26-4"></a><span class="cm">  blabla blabla</span>
</span><span id="__span-26-5"><a href="#__codelineno-26-5" id="__codelineno-26-5" name="__codelineno-26-5"></a><span class="cm">  blabla blabla</span>
</span><span id="__span-26-6"><a href="#__codelineno-26-6" id="__codelineno-26-6" name="__codelineno-26-6"></a><span class="cm">--&gt;</span>
</span></code></pre></div>
</article>>